#reserved-query.properties
# Insert for reserve
reservePayment=INSERT INTO PAYMENT VALUES(SQE_PM.NEXTVAL, SYSDATE, ?, ?, DEFAULT,NULL)
reserveMovie=INSERT INTO RESERVED VALUES(SQE_RV.NEXTVAL, SQE_PM.CURRVAL, ?, ?)
reserveSeat=INSERT INTO RSV_SEAT VALUES(SQE_RS.NEXTVAL, ?, SQE_RV.CURRVAL)
reserveMem=INSERT INTO RSV_MEM VALUES(SQE_RV.CURRVAL, ?, ?)
updateCount=UPDATE MEMBER M SET M.TICKET_COUNT = M.TICKET_COUNT+1 WHERE M.MEMBER_NO=?

# select reservedInfo
reserveInfo=SELECT RESERVED_NO, PAYMENT_NO, MEMBER_NO, SCREEN_NO FROM RESERVED WHERE RESERVED_NO= (SELECT MAX(RESERVED_NO) FROM RESERVED WHERE MEMBER_NO=?)
reservedSeats=SELECT RS.SEAT_NO FROM RSV_SEAT RS JOIN RESERVED R ON (RS.RESERVED_NO = R.RESERVED_NO) JOIN PAYMENT P ON (R.PAYMENT_NO = P.PAYMENT_NO) WHERE SCREEN_NO=? AND P.REFUND_STATUS='N' ORDER BY SEAT_NO
countReserve=SELECT COUNT(R.RESERVED_NO) "COUNT" FROM RESERVED R JOIN PAYMENT P ON (R.PAYMENT_NO = P.PAYMENT_NO) JOIN SCREEN S ON (S.SCREEN_NO = R.SCREEN_NO) WHERE P.REFUND_STATUS='N' AND TO_CHAR(SCREEN_DATE, 'YYYYMMDDHH24MISS')>= TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
listOfAllReserved=SELECT B.* FROM (SELECT ROWNUM AS RNUM, A.* FROM(SELECT R.RESERVED_NO, P."DATE" "PAYMETN_DATE", T.NAME "T_NAME", RO.NAME "R_NAME", M.TITLE, M.AGE_LIMIT, S.SCREEN_DATE, P.PAYMENT_NO, P.AMOUNT, MM.MEMBER_NO, MM."ID", P."TYPE", SI.MODIFY_NAME FROM RESERVED R JOIN PAYMENT P ON (R.PAYMENT_NO = P.PAYMENT_NO) JOIN SCREEN S ON (S.SCREEN_NO = R.SCREEN_NO) JOIN ROOM RO ON (RO.ROOM_NO = S.ROOM_NO) JOIN THEATER T ON (T.THEATER_NO = RO.THEATER_NO) JOIN MOVIE M ON (M.MOVIE_NO = S.MOVIE_NO) JOIN MEMBER MM ON (MM.MEMBER_NO = R.MEMBER_NO) JOIN STILL_IMAGE SI ON (M.MOVIE_NO = SI.MOVIE_NO) WHERE P.REFUND_STATUS='N' AND SI."LEVEL"=0 AND TO_CHAR(SCREEN_DATE, 'YYYYMMDDHH24MISS')>= TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') ORDER BY SCREEN_DATE) A) B WHERE RNUM BETWEEN ? AND ?
reservedMem=SELECT MC.MEM_TYPE, RC.RESERVED_COUNT FROM RSV_MEM RC JOIN MEM_CODE MC ON (RC.MEM_CODE = MC.MEM_CODE) WHERE RESERVED_NO=?
seatByRsvNo=SELECT * FROM RSV_SEAT WHERE RESERVED_NO=? ORDER BY SEAT_NO
findReservedInfo=SELECT R.RESERVED_NO, P."DATE" "PAYMETN_DATE", T.NAME "T_NAME", RO.NAME "R_NAME", M.TITLE, M.AGE_LIMIT, S.SCREEN_DATE, P.PAYMENT_NO, P.AMOUNT, MM.MEMBER_NO, MM."ID", P."TYPE", SI.MODIFY_NAME FROM RESERVED R JOIN PAYMENT P ON (R.PAYMENT_NO = P.PAYMENT_NO) JOIN SCREEN S ON (S.SCREEN_NO = R.SCREEN_NO) JOIN ROOM RO ON (RO.ROOM_NO = S.ROOM_NO) JOIN THEATER T ON (T.THEATER_NO = RO.THEATER_NO) JOIN MOVIE M ON (M.MOVIE_NO = S.MOVIE_NO) JOIN MEMBER MM ON (MM.MEMBER_NO = R.MEMBER_NO) JOIN STILL_IMAGE SI ON (M.MOVIE_NO = SI.MOVIE_NO) WHERE R.RESERVED_NO=?
findRSVInfoByUserNo=SELECT R.RESERVED_NO, P."DATE" "PAYMETN_DATE", T.NAME "T_NAME", RO.NAME "R_NAME", M.TITLE, M.AGE_LIMIT, S.SCREEN_DATE, P.PAYMENT_NO, P.AMOUNT, MM.MEMBER_NO, MM."ID", P."TYPE", SI.MODIFY_NAME FROM RESERVED R JOIN PAYMENT P ON (R.PAYMENT_NO = P.PAYMENT_NO) JOIN SCREEN S ON (S.SCREEN_NO = R.SCREEN_NO) JOIN ROOM RO ON (RO.ROOM_NO = S.ROOM_NO) JOIN THEATER T ON (T.THEATER_NO = RO.THEATER_NO) JOIN MOVIE M ON (M.MOVIE_NO = S.MOVIE_NO) JOIN MEMBER MM ON (MM.MEMBER_NO = R.MEMBER_NO) JOIN STILL_IMAGE SI ON (M.MOVIE_NO = SI.MOVIE_NO) WHERE TO_CHAR(SCREEN_DATE, 'YYYYMMDDHH24MISS')>= TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AND R.MEMBER_NO = ? AND P.REFUND_STATUS='N' AND SI."LEVEL"=0 ORDER BY SCREEN_DATE
countReserveOne=SELECT COUNT(R.RESERVED_NO) "COUNT" FROM RESERVED R JOIN PAYMENT P ON (R.PAYMENT_NO = P.PAYMENT_NO) JOIN SCREEN S ON (S.SCREEN_NO = R.SCREEN_NO) WHERE P.REFUND_STATUS='N' AND TO_CHAR(SCREEN_DATE, 'YYYYMMDDHH24MISS')>= TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AND MEMBER_NO=?
oneReserved=SELECT B.* FROM (SELECT ROWNUM AS RNUM, A.* FROM(SELECT R.RESERVED_NO, P."DATE" "PAYMETN_DATE", T.NAME "T_NAME", RO.NAME "R_NAME", M.TITLE, M.AGE_LIMIT, S.SCREEN_DATE, P.PAYMENT_NO, P.AMOUNT, MM.MEMBER_NO, MM."ID", P."TYPE", SI.MODIFY_NAME FROM RESERVED R JOIN PAYMENT P ON (R.PAYMENT_NO = P.PAYMENT_NO) JOIN SCREEN S ON (S.SCREEN_NO = R.SCREEN_NO) JOIN ROOM RO ON (RO.ROOM_NO = S.ROOM_NO) JOIN THEATER T ON (T.THEATER_NO = RO.THEATER_NO) JOIN MOVIE M ON (M.MOVIE_NO = S.MOVIE_NO) JOIN MEMBER MM ON (MM.MEMBER_NO = R.MEMBER_NO) JOIN STILL_IMAGE SI ON (M.MOVIE_NO = SI.MOVIE_NO) WHERE P.REFUND_STATUS='N' AND SI."LEVEL"=0 AND TO_CHAR(SCREEN_DATE, 'YYYYMMDDHH24MISS')>= TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') AND R.MEMBER_NO=? ORDER BY SCREEN_DATE) A) B WHERE RNUM BETWEEN ? AND ?

# refund reserved -> payment_status = 'y'
cancelPayment=UPDATE PAYMENT SET REFUND_STATUS='N', REFUND_DATE=SYSDATE WHERE PAYMENT_NO = (SELECT P.PAYMENT_NO FROM RESERVED R JOIN PAYMENT P ON (R.PAYMENT_NO=P.PAYMENT_NO) WHERE R.RESERVED_NO=?)

